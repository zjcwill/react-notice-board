{"version":3,"file":"mylib.cjs.production.min.js","sources":["../src/index.tsx"],"sourcesContent":["import * as React from 'react';\nimport styled, { keyframes, Keyframes } from 'styled-components';\nimport IMG_BRAND from './IMG_BRAND';\n\ninterface IProps {\n  dataSource: string[];\n  stepDuration?: number;\n  width?: number;\n  height?: number;\n  extra?: React.ReactElement | null | false;\n  textClassName?: string | undefined;\n  hideBrand?: boolean;\n}\ninterface IState {\n  dataSource: string[];\n  keyframesValue: string;\n}\ninterface IContent extends IProps {\n  animation: Keyframes | null;\n  duration: number;\n}\n\nconst Wrapper = styled.div<IProps>`\n  width: ${props => (props.width ? `${props.width}px` : '100%')};\n  height: ${props => (props.height ? `${props.height}px` : '44px')};\n  background: rgba(255, 255, 255, 1);\n  box-shadow: 0px 0px 2px 0px rgba(0, 0, 0, 0.1);\n  border-radius: 2px;\n  overflow: hidden;\n  display: flex;\n`;\n\nconst LogoImg = styled.img`\n  width: 31px;\n  height: 14px;\n  margin: auto 0 auto 16px;\n`;\n\nconst Content = styled.div<IContent>`\n  overflow: hidden;\n  animation: ${props => (props.animation ? props.animation : '')}\n    ${props => props.duration}s linear infinite;\n  margin-right: auto;\n  margin-left: 12px;\n`;\nconst Text = styled.p<IProps>`\n  color: #ff6f41;\n  line-height: ${props => (props.height ? `${props.height}px` : '44px')};\n  margin: 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n`;\n\nconst ExtraWrapper = styled.div`\n  float: right;\n  display: flex;\n  align-items: center;\n`;\n\nexport default class NoticeBoard extends React.PureComponent<IProps, IState> {\n  static defaultProps = {\n    stepDuration: 1000,\n    height: 44,\n    className: '',\n    hideBrand: false,\n  };\n  constructor(props: IProps) {\n    super(props);\n    this.state = {\n      dataSource: [],\n      keyframesValue: ``,\n    };\n  }\n  componentDidMount = () => {\n    this.init();\n  };\n  componentWillReceiveProps(nextProps: any) {\n    if (\n      JSON.stringify(nextProps.dataSource) !==\n      JSON.stringify(this.props.dataSource)\n    ) {\n      this.init();\n    }\n  }\n  handleDataSource = () => {\n    const { dataSource = [] } = this.props;\n    return new Promise((resolve, reject) => {\n      if (dataSource.length > 0) {\n        this.setState(\n          {\n            dataSource: dataSource.concat(dataSource[0]),\n          },\n          () => {\n            resolve();\n          }\n        );\n      } else {\n        reject('dataSource.length must >= 1');\n        throw new Error('dataSource.length must >= 1');\n      }\n    });\n  };\n  get stepLen() {\n    const { dataSource = [] } = this.props;\n    return dataSource.length * 2;\n  }\n  get duration() {\n    const { stepDuration = 1000, dataSource } = this.props;\n\n    return (dataSource.length * stepDuration) / 1000;\n  }\n\n  get scrollKeyFrames() {\n    const { keyframesValue } = this.state;\n    if (keyframesValue) {\n      return keyframes`\n        ${keyframesValue}\n      `;\n    }\n    return null;\n  }\n\n  init = async () => {\n    await this.handleDataSource();\n    this.createKeyFrames();\n  };\n  createKeyFrames = () => {\n    const { height = 0 } = this.props;\n    const per = 100 / this.stepLen;\n    let offset = 0;\n    const cssStr: string[] = [];\n    for (let i = 0; i <= this.stepLen; i++) {\n      const even = i % 2 === 0;\n      if (i !== 0 && even) {\n        offset += height;\n      }\n      const v = `\n        ${i * per}% {\n          margin-top: -${offset}px\n        }\n      `;\n      cssStr.push(v);\n    }\n    const css = cssStr.join('');\n    this.setState({ keyframesValue: css });\n  };\n  render() {\n    const { dataSource } = this.state;\n    const { extra, textClassName, hideBrand } = this.props;\n    return (\n      <div>\n        <Wrapper {...this.props}>\n          {!hideBrand && <LogoImg src={IMG_BRAND} />}\n          <Content\n            {...this.props}\n            animation={this.stepLen > 2 ? this.scrollKeyFrames : null}\n            duration={this.duration}\n          >\n            {dataSource.map((item, index) => (\n              <Text\n                {...this.props}\n                className={textClassName}\n                key={`${index}-${item}`}\n              >\n                {item}\n              </Text>\n            ))}\n          </Content>\n          {extra && <ExtraWrapper>{extra}</ExtraWrapper>}\n        </Wrapper>\n      </div>\n    );\n  }\n}\n"],"names":["Wrapper","styled","div","_templateObject","props","width","height","LogoImg","img","_templateObject2","Content","_templateObject3","animation","duration","Text","p","_templateObject4","ExtraWrapper","_templateObject5","NoticeBoard","init","_this","dataSource","Promise","resolve","reject","length","Error","setState","concat","handleDataSource","createKeyFrames","per","stepLen","offset","cssStr","i","push","css","join","keyframesValue","state","componentWillReceiveProps","nextProps","JSON","stringify","this","render","extra","textClassName","hideBrand","React","src","scrollKeyFrames","map","item","index","_this2","className","key","stepDuration","keyframes"],"mappings":"8kCAsBA,IAAMA,EAAUC,EAAOC,IAAVC,KACF,SAAAC,UAAUA,EAAMC,MAAWD,EAAMC,WAAY,UAC5C,SAAAD,UAAUA,EAAME,OAAYF,EAAME,YAAa,UAQrDC,EAAUN,EAAOO,IAAVC,KAMPC,EAAUT,EAAOC,IAAVS,KAEE,SAAAP,UAAUA,EAAMQ,UAAYR,EAAMQ,UAAY,MACvD,SAAAR,UAASA,EAAMS,YAIfC,EAAOb,EAAOc,EAAVC,KAEO,SAAAZ,UAAUA,EAAME,OAAYF,EAAME,YAAa,UAO1DW,EAAehB,EAAOC,IAAVgB,KAMGC,iCAOPf,8BACJA,4BAMY,aACbgB,2BAUY,iBACWC,EAAKjB,MAAzBkB,WAAAA,aAAa,YACd,IAAIC,SAAQ,SAACC,EAASC,QACvBH,EAAWI,OAAS,SAUtBD,EAAO,+BACD,IAAIE,MAAM,iCAVXC,SACH,CACEN,WAAYA,EAAWO,OAAOP,EAAW,MAE3C,WACEE,wDA8BFH,EAAKS,uCACNC,2EAEW,qBACOV,EAAKjB,MAApBE,OAAAA,aAAS,IACX0B,EAAM,IAAMX,EAAKY,QACnBC,EAAS,EACPC,EAAmB,GAChBC,EAAI,EAAGA,GAAKf,EAAKY,QAASG,IAEvB,IAANA,GADSA,EAAI,GAAM,IAErBF,GAAU5B,GAOZ6B,EAAOE,kBAJHD,EAAIJ,iCACWE,+BAKfI,EAAMH,EAAOI,KAAK,MACnBX,SAAS,CAAEY,eAAgBF,OA5E3BG,MAAQ,CACXnB,WAAY,GACZkB,yIAMJE,0BAAA,SAA0BC,GAEtBC,KAAKC,UAAUF,EAAUrB,cACzBsB,KAAKC,UAAUC,KAAK1C,MAAMkB,kBAErBF,UAiET2B,OAAA,sBACUzB,EAAewB,KAAKL,MAApBnB,aACoCwB,KAAK1C,MAAzC4C,IAAAA,MAAOC,IAAAA,cAAeC,IAAAA,iBAE5BC,2BACEA,gBAACnD,mBAAY8C,KAAK1C,QACd8C,GAAaC,gBAAC5C,GAAQ6C,+7BACxBD,gBAACzC,mBACKoC,KAAK1C,OACTQ,UAAWkC,KAAKb,QAAU,EAAIa,KAAKO,gBAAkB,KACrDxC,SAAUiC,KAAKjC,WAEdS,EAAWgC,KAAI,SAACC,EAAMC,UACrBL,gBAACrC,mBACK2C,EAAKrD,OACTsD,UAAWT,EACXU,IAAQH,MAASD,IAEhBA,OAINP,GAASG,gBAAClC,OAAc+B,8CAjEHF,KAAK1C,MAAzBkB,kBACmB,cADN,MACHI,8CAG0BoB,KAAK1C,UAAzCwD,sBAAqBtC,WAEVI,mBAFI,OAEqB,gDAIpCc,EAAmBM,KAAKL,MAAxBD,sBACJA,EACKqB,gBACHrB,GAGC,iMA5D8BW,gCACjB,CACpBS,aAAc,IACdtD,OAAQ,GACRoD,UAAW,GACXR,WAAW"}